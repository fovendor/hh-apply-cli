# hh-apply-cli

hh-apply-cli — это CLI-инструмент для интерактивного поиска вакансий на HeadHunter, позволяющий быстро фильтровать, просматривать и массово откликаться на выбранные вакансии из терминала. Скрипт использует утилиту [hh-applicant-tool](https://github.com/s3rgeym/hh-applicant-tool) для взаимодействия с API hh.ru и оборачивает её в TUI-интерфейс на базе `fzf`.
 
![gif of hh-cli](img/review.gif "A short demo CLI TUI interface").

## Оглавление

- [Основная идея](#основная-идея)
- [Ключевые возможности](#ключевые-возможности)
- [Установка](#установка)
  - [Шаг 1: Установка `hh-applicant-tool`](#шаг-1-установка-hh-applicant-tool)
  - [Шаг 2: Установка `hh-apply-cli` и зависимостей](#шаг-2-установка-hh-apply-cli-и-зависимостей)
- [Принцип работы](#принцип-работы)
  - ["Умное" кэширование и защита от блокировок](#умное-кэширование-и-защита-от-блокировок)
  - [Обработка ошибок API и ограничений платформы](#обработка-ошибок-api-и-ограничений-платформы)
- [Оговорка](#оговорка)
- [Лицензия](#лицензия)
- [Благодарности](#благодарности)

## Основная идея

С конца 2024 года поиск работы стал неимоверно трудным и рутинным процессом. Ещё сильнее дело осложняется роботами, кривыми MCP-серверами с LLM, которые как-то (на самом деле ХЗ, как именно, у каждой компании свои причуды) отсеивают отклики и отвечают отказом или игнором. Часто встречаются вакансии, набирающие по 3000+ откликов за сутки. 

В таких условиях просиживание на hh.ru, применение одних и тех же фильтров, просмотр сотен вакансий, отслеживание подходящих и запоминание, куда уже был отправлен отклик — очень неприятный и длительный процесс. Скрипт `hh-apply-cli` автоматизирует большую часть этой рутины. Без рекламы и СМС, инфошума, медленной загрузки ~~крайне уродского~~ фронтенда и лишних сотен кликов. Вся информация — в вашем терминале.

## Ключевые возможности

- **Гибкий поиск:** Фильтрация по специальностям, ключевым словам с поддержкой `OR`, `AND`, `NOT`, по графику работы и т.д.
- **Интерактивная таблица:** Удобное представление найденных вакансий с возможностью сортировки и поиска на лету.
- **Предпросмотр на лету:** При выборе вакансии в списке справа выводится её полное описание, отформатированное для удобного чтения.
- **Защита от повторных откликов:** Скрипт определяет и помечает компании, на вакансии которых вы уже откликались. Не нужно запоминать, куда отправлялся отклик.
- **Дедупликация:** Автоматическое удаление дублей вакансий по паре "Название + Компания" для защиты от десятков одинаковых вакансий в разных городах.
- **Массовые отклики:** Возможность выбрать несколько вакансий (клавишей `Tab`) и откликнуться на все нажатием на `Enter`.
- **Поддержка сопроводительных писем:** Используется письмо по умолчанию из конфига `hh-applicant-tool` или из кастомного файла.
- **Безопасность:** Перед отправкой откликов требуется ввести случайно сгенерированный код для защиты от случайных действий.
- **"Умное" кэширование:** Детальные описания вакансий кэшируются на лету при просмотре. При повторном просмотре не вызывается API hh.ru, что предотвращает блокировки.
- **Отчетность:** Каждый сеанс откликов сохраняется в CSV-отчёте. Отчёты складируются в каталоги по датам.

## Установка

### Шаг 1: Установка `hh-applicant-tool`

```bash
# Клонируем репозиторий
git clone https://github.com/s3rgeym/hh-applicant-tool.git
cd hh-applicant-tool

# Создаем и активируем виртуальную среду
python3 -m venv venv
source venv/bin/activate

# Устанавливаем саму утилиту и ее QT-зависимости для авторизации
pip install . 
pip install 'hh-applicant-tool[qt]'

# Проверяем, что утилита работает
hh-applicant-tool -h

# Проходим процедуру аутентификации (откроется окно QT-браузера)
hh-applicant-tool authorize

# Проверяем, что аутентификация удалась
hh-applicant-tool whoami
```

**Конфиг с сопроводительным письмом:**

Чтобы узнать, где находится конфиг, выполните:

```bash
hh-applicant-tool config -p
```

Откройте любым текстовым редактором и вставьте ваш вариант сопроводительного письма. Например:

```yaml
{
  "reply_message": "Здравствуйте!\n\nПонравилось описание вакансии, хотелось бы подробнее узнать о ваших требованиях к кандидату и о задачах.\n\nКоротко о себе:\nБолее восьми лет занимаюсь управлением проектами, анализом и операционкой в IT. Имею сильный технический бэкграунд: проектирую системы на уровне архитектуры и сам программирую. Хорошо понимаю весь жизненный цикл разработки софта по SDLC, в двух компаниях с нуля построил воркфлоу разработки и CI/CD. Обладаю значительным опытом работы анализа и формализации требований. Прошёл школу заказной и продуктовой разработки в крупных компаниях, умею вести переговоры с высокими ставками.\n\nБуду рад обсудить, как мой опыт может быть для вас полезен.\n\nС уважением,\Имя Фамилия\n+7 (000) 000-00-00 | Tg: @никнейм | почта@gmail.com",
  "telemetry_client_id": "_______",
  "token": {
    "access_expires_at": _______,
    "access_token": "_______",
    "refresh_token": "_______"
  }
}
```

**Важно:** Убедитесь, что после активации виртуальной среды (`source venv/bin/activate`) вы остаетесь в этой же сессии терминала для последующих шагов.

### Шаг 2: Установка `hh-apply-cli` и зависимостей

1.  **Установите зависимости для интерактивного интерфейса:**

    ```bash
    # Для Debian/Ubuntu
    sudo apt update
    sudo apt install jq fzf w3m curl

    # Для macOS (с помощью Homebrew)
    brew install jq fzf w3m curl
    ```

2.  **Создайте файл скрипта `hh-apply-cli`:**
    
    Рекомендуется размещать скрипт в директории, которая находится в вашем `$PATH`, чтобы вы могли вызывать его из любого места. Например, `/usr/local/bin/`.

    ```bash
    # Создаем файл
    sudo nano /usr/local/bin/hh-apply-cli
    ```

3.  **Скопируйте код** скрипта `hh-apply-cli` и вставьте его в открывшийся редактор `nano`.
    -   Для вставки: `Ctrl + Shift + V` (в большинстве терминалов)
    -   Для сохранения: `Ctrl + O`, затем `Enter`
    -   Для выхода: `Ctrl + X`

4.  **Сделайте скрипт исполняемым:**

    ```bash
    sudo chmod +x /usr/local/bin/hh-apply-cli
    ```

## Принцип работы

### "Умное" кэширование и защита от блокировок

1.  Скрипт не загружает описания всех найденных вакансий сразу. Вместо этого он делает API-запрос на получение деталей **только в тот момент, когда вы выбираете вакансию курсором** в интерактивном режиме. Результат этого запроса сохраняется в локальный кэш. После кэширования, при повторном выборе вакансии, её описание выводится из кэша без задержек и лишних вызовов API.

2.  Время, которое вы тратите на чтение описания, является естественной паузой между API-запросами, что делает поведение скрипта похожим на человеческое. **Важно!** Не рекомендуется быстро "пролистывать" весь список вакансий стрелками, это может быть расценено hh.ru как роботизированная активность и привести к временной блокировке сессии (потребуется капча).

3.  **Расположение кэша:** Все файлы кэша хранятся в директории `~/.cache/hh-apply-cli-cache/`. Если по какой-то причине вам необходимо очистить кэш, выполните команду:
    ```bash
    rm -rf ~/.cache/hh-apply-cli-cache
    ```

### Обработка ошибок API и ограничений платформы

Скрипт умеет обрабатывать ~~криворукость разработчиков~~ некоторые странности в ответах API hh.ru:

1.  **Пустое описание (`description: null`):** Если API возвращает вакансию без описания, скрипт не упадет, а выведет в панели предпросмотра сообщение: `[ Описание для этой вакансии недоступно через API ]`.

2.  **"Битые" JSON:** В редких случаях API может вернуть некорректный JSON. Скрипт обнаружит это, выведет сообщение об ошибке, удалит поврежденный файл из кэша и предложит просмотреть вакансию еще раз (что вызовет повторную загрузку).

3.  **Проверка на "сложные" вакансии:** Скрипт умеет определять вакансии, требующие ответа на вопросы во время отклика (`is_complex_vacancy`). Эта проверка надёжна, так как использует уже закэшированные данные. Отклики на такие вакансии будут пропущены, информация об этом будет в консоли и в CSV-отчёте, и вы сможете откликнуться на такую вакансию вручную.

## Оговорка

Вся работа с API делегирована утилите `hh-applicant-tool`. Если в ней произойдут критические изменения или она перестанет работать из-за изменений на стороне hh.ru, этот скрипт также перестанет работать.

## Лицензия

[MIT](https://choosealicense.com/licenses/mit/)

## Благодарности

- Огромная благодарность **Сергею ([s3rgeym](https://github.com/s3rgeym))** за создание и поддержку [hh-applicant-tool](https://github.com/s3rgeym/hh-applicant-tool).